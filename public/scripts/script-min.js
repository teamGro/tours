const menuBtn=document.querySelector(".menu-btn"),menuContainer=document.querySelector(".menu");menuBtn.addEventListener("click",function(){this.classList.toggle("menu-btn_open"),this.classList.contains("menu-btn_open")?this.classList.remove("menu-btn_close"):this.classList.add("menu-btn_close"),menuContainer.classList.toggle("menu_open")});const countriesField=document.querySelector(".search__field_country"),countriesFieldName=document.querySelector(".search__title_country");countriesField.addEventListener("click",function(e){let t=e.target;if(t.closest(".search__field-wrap")){if(null==this.querySelector(".menu__list")){let e=renderCountriesList(countries,{main:"menu__list countries menu__list_disactive",sub:"countries__places countries__places_disactive"},{main:"menu__item",sub:"places",allTours:"places_all"});return this.append(e),this.querySelector(".search__more").classList.add("search__more_open"),void this.querySelector(".menu__list").classList.toggle("menu__list_disactive")}return this.querySelector(".menu__list").classList.toggle("menu__list_disactive"),void this.querySelector(".search__more").classList.toggle("search__more_open")}t.closest(".places")&&(countriesFieldName.textContent=t.textContent,this.querySelector(".countries__places").classList.toggle("countries__places_disactive"),this.querySelector(".search__more").classList.toggle("search__more_open"),this.querySelector(".menu__list").classList.toggle("menu__list_disactive")),t.querySelector(".countries__places").classList.toggle("countries__places_disactive")});let months={0:"Январь",1:"Февраль",2:"Март",3:"Апрель",4:"Май",5:"Июнь",6:"Июль",7:"Август",8:"Сентябрь",9:"Октябрь",10:"Ноябрь",11:"Декабрь"};const dateField=document.querySelector(".search__field_dates");let date=new Date,month=date.getMonth(),currentMonth=month,year=date.getFullYear(),currentYear=year,monthYearField=dateField.querySelector(".calendar__month");monthYearField.textContent=`${months[currentMonth]} ${currentYear}`;let userDates=[];const btnNextMonth=dateField.querySelector(".calendar__btn_next");btnNextMonth.addEventListener("click",function(){const e=dateField.querySelector(".calendar__table"),t=dateField.querySelector(".calendar__container");12==++currentMonth&&(currentMonth=0,currentYear++),e.remove(),createCalendar(t,currentYear,currentMonth),monthYearField.textContent=`${months[currentMonth]} ${currentYear}`});const btnPrevMonth=dateField.querySelector(".calendar__btn_prev");btnPrevMonth.addEventListener("click",function(){let e=dateField.querySelector(".calendar__table"),t=dateField.querySelector(".calendar__container");-1==--currentMonth&&(currentMonth=11,currentYear--),e.remove(),createCalendar(t,currentYear,currentMonth),monthYearField.textContent=`${months[currentMonth]} ${currentYear}`}),dateField.addEventListener("click",function(e){let t=e.target;if(t.closest(".search__field-wrap")&&"TD"!=t.tagName){if(null==this.querySelector(".calendar__table")){return createCalendar(this.querySelector(".calendar__container"),year,month),this.querySelector(".search__more").classList.add("search__more_open"),void this.querySelector(".calendar").classList.toggle("calendar_disactive")}this.querySelector(".calendar").classList.toggle("calendar_disactive"),this.querySelector(".search__more").classList.toggle("search__more_open")}});let calendarContainer=dateField.querySelector(".calendar__container");calendarContainer.addEventListener("click",e=>{let t=e.target;if("TH"==t.tagName)return;t.className="calendar__set-day";let n=t.textContent;+n<10&&(n=`0${n}`);let r=currentMonth+1;r<10&&(r=`0${r}`),userDates.push(`${n}.${r}.${currentYear}`),2==userDates.length&&(dateField.querySelector(".calendar").classList.toggle("calendar_disactive"),dateField.querySelector(".search__more").classList.toggle("search__more_open"),userDates[1]>userDates[0]?dateField.querySelector(".search__title_dates").textContent=`${userDates[0]} - ${userDates[1]}`:dateField.querySelector(".search__title_dates").textContent=`${userDates[1]} - ${userDates[0]}`,Array.from(dateField.querySelectorAll(".calendar__set-day")).forEach(e=>{e.classList.remove("calendar__set-day")}),userDates=[])});const tripField=document.querySelector(".search__field_type"),tripFieldName=document.querySelector(".search__title_type");tripField.addEventListener("click",function(e){let t=e.target;if(t.closest(".search__field-wrap")){if(null==this.querySelector(".menu__list")){let e=renderTripTypes(tripTypes,"menu__list trips","menu__item trip__item");return this.append(e),void this.querySelector(".search__more").classList.add("search__more_open")}return this.querySelector(".menu__list").classList.toggle("menu__list_disactive"),void this.querySelector(".search__more").classList.toggle("search__more_open")}t.closest(".trip__item")&&(this.querySelector(".menu__list").classList.toggle("menu__list_disactive"),this.querySelector(".search__more").classList.toggle("search__more_open"),tripFieldName.textContent=t.textContent)});const toursFilterBtns=document.querySelector(".tours__btn-wrap"),tours=document.querySelector(".offers"),toursOffers=document.querySelectorAll("[data-country]"),toursFilters=document.querySelector(".filters"),toursBtnArrow=document.querySelector(".tours__btn-arrow"),filterItalyBtn=document.querySelector("#italy");filterItalyBtn.addEventListener("click",function(e){filterHandler(this,e)});const filterIslandBtn=document.querySelector("#island");filterIslandBtn.addEventListener("click",function(e){filterHandler(this,e)});const filterTurkeyBtn=document.querySelector("#turkey");filterTurkeyBtn.addEventListener("click",function(e){filterHandler(this,e)});const filterSpainBtn=document.querySelector("#spain");filterSpainBtn.addEventListener("click",function(e){filterHandler(this,e)});const downloadToursBtn=document.querySelector(".tours__download");downloadToursBtn.addEventListener("click",function(){let e=document.getElementsByClassName("offers__item_mobile");e=Array.from(e);for(let t=0;t<=2;t++){if(!e[t]){this.setAttribute("disabled","disabled");break}e[t].classList.remove("offers__item_mobile"),e[t].classList.add("offers__item_mobile-visible")}});const heightHotContainer=document.querySelector(".offers__item"),btnNextSlideHot=document.querySelector(".tours__btn-arrow_hot"),imgHeightPop=document.querySelector(".popular__img"),btnNextSlidePop=document.querySelector(".tours__btn-arrow_pop");window.addEventListener("DOMContentLoaded",()=>{btnNextSlideHot.style.top=heightHotContainer.offsetHeight-btnNextSlideHot.offsetHeight/2+"px",btnNextSlidePop.style.top=imgHeightPop.offsetHeight/2-btnNextSlidePop.offsetHeight/2+"px"});let dataPatterns={name:/^[а-яa-z0-9_-\S]{3,16}$/i,phone:/^((\+?7|8)[ \-]?)?((\(\d{3}\))|(\d{3}))?([ \-])?(\d{3}[\- ]?\d{2}[\- ]?\d{2})$/,country:/^[а-яa-z0-9_-\S]{5,30}$/i};const userName=document.querySelector("#user-name");userName.value=localStorage.getItem("user-name")||"",userName.addEventListener("blur",function(){onBlurHandle(this,"form__invalid","name")}),userName.addEventListener("focus",function(){onFocusHandle(this,"form__invalid")});const userWishes=document.querySelector("#user-wishes");userWishes.value=localStorage.getItem("user-country")||"",userWishes.addEventListener("blur",function(){onBlurHandle(this,"form__invalid","country")}),userWishes.addEventListener("focus",function(){onFocusHandle(this,"form__invalid")});const userTel=document.querySelector("#user-tel");userTel.value=localStorage.getItem("user-tel")||"",userTel.addEventListener("blur",function(){""!==this.value.trim()&&(dataPatterns.phone.test(this.value)?localStorage.setItem("user-tel",this.value):this.classList.add("form__invalid"))}),userTel.addEventListener("focus",function(){onFocusHandle(this,"form__invalid")});const templ=document.querySelector("#templ");let connections=document.querySelector(".form__connection");connections.addEventListener("click",function(e){let t=e.target;"SPAN"==t.tagName&&t.classList.contains("chk__input")&&t.classList.toggle("chk__input_active"),"LABEL"===t.tagName&&t.classList.contains("chk__label")&&t.parentNode.querySelector(".chk__input").classList.toggle("chk__input_active")});const contacts=document.querySelector(".form__contact");contacts.addEventListener("click",function(e){let t=e.target;"SPAN"==t.tagName&&t.classList.contains("chk__input")&&t.classList.toggle("chk__input_active"),"LABEL"===t.tagName&&t.classList.contains("chk__label")&&t.parentNode.querySelector(".chk__input").classList.toggle("chk__input_active")});const agreementsSubscibe=document.querySelector(".agreements__input_subscribe");agreementsSubscibe.addEventListener("click",function(){this.classList.toggle("agreements__input_active")});const agreementsHandle=document.querySelector(".agreements__input_handle"),popupContainer=templ.content.querySelector(".popup"),overlay=document.querySelector(".overlay");agreementsHandle.addEventListener("click",function(){if(this.classList.toggle("agreements__input_active"),this.classList.contains("agreements__input_active")){let e;document.body.style.overflow="hidden",overlay.classList.add("overlay_active"),overlay.style.top=window.pageYOffset+"px",overlay.children.length||(e=popupContainer.cloneNode(!0),overlay.append(e)),overlay.querySelector(".popup__btn_agree").addEventListener("click",()=>{document.body.style.overflow="",overlay.classList.remove("overlay_active")}),overlay.querySelector(".popup__btn_disagree").addEventListener("click",()=>{document.body.style.overflow="",this.classList.remove("agreements__input_active"),overlay.classList.remove("overlay_active")}),overlay.querySelector(".popup__close-btn").addEventListener("click",()=>{document.body.style.overflow="",this.classList.remove("agreements__input_active"),overlay.classList.remove("overlay_active")})}});let btnSend=document.querySelector(".btn-send");btnSend.addEventListener("click",function(e){e.preventDefault();agreementsHandle.classList.contains("agreements__input_active")||(0,agreementsHandle.classList.add("agreements__input_handle-invalid")),""===userWishes.value.trim()&&(0,userWishes.classList.add("form__invalid")),""===userName.value.trim()&&(0,userName.classList.add("form__invalid"))}),new Glide(".glide",{}).mount(),new Glide(".glide2",{bound:!0,startAt:0,breakpoints:{2000:{perView:2},1023:{perView:3},767:{perView:2}}}).mount();let canvasTopElem=document.querySelector(".footer__item-line_top"),canvasBottomElem=document.querySelector(".footer__item-line_bottom");if(canvasTopElem.getContext){let e=canvasTopElem.getContext("2d");e.strokeStyle="rgb(255, 255, 255)",e.lineWidth=5,e.beginPath(),e.moveTo(0,0),e.lineTo(54.5,74),e.lineTo(5e3,74),e.stroke();let t=canvasBottomElem.getContext("2d");t.strokeStyle="rgb(255, 255, 255)",t.lineWidth=5,t.beginPath(),t.moveTo(0,80),t.lineTo(54.5,3),t.lineTo(5e3,3),t.stroke()}function filterHandler(e,t){let n=t.target.id;if(e.classList.contains("tours__btn_active")){if(e.classList.remove("tours__btn_active"),null!=e.parentNode.querySelector(".tours__btn_active"))return void Array.from(toursFilters.querySelectorAll(`[data-country=${n}]`)).forEach(e=>{e.parentNode.removeChild(e)});for(tours.style.display="flex",toursBtnArrow.style.display="block";toursFilters.firstChild;)toursFilters.removeChild(toursFilters.firstChild);return}let r=document.createDocumentFragment();Array.from(toursOffers).forEach(e=>{if(e.getAttribute("data-country")==n){let t=e.cloneNode(!0);r.append(t)}}),toursFilters.append(r),toursFilters.style.display="flex",tours.style.display="none",toursBtnArrow.style.display="none",e.classList.add("tours__btn_active")}function onBlurHandle(e,t,n){dataPatterns[n].test(e.value)?localStorage.setItem(`user-${n}`,e.value):e.classList.add(t)}function onFocusHandle(e,t){e.classList.contains(t)&&e.classList.remove(t)}let countries={"Южная Америка":[{name:"Аргентина",link:"#"},{name:"Бразилия",link:"#"},{name:"Перу",link:"#"},{name:"Уругвай",link:"#"},{name:"все туры на континенте",link:"#"}],"Арктика и Антарктика":[{name:"Арктика",link:"#"},{name:"Антарктика",link:"#"},{name:"все туры на континенте",link:"#"}],"Северная Америка":[{name:"США",link:"#"},{name:"Мексика",link:"#"},{name:"Канада",link:"#"},{name:"все туры на континенте",link:"#"}],"Африка":[{name:"Египет",link:"#"},{name:"Нигерия",link:"#"},{name:"все туры на континенте",link:"#"}],"Австралия и Океания":[{name:"Австралия",link:"#"},{name:"Океания",link:"#"},{name:"все туры на континенте",link:"#"}],"Европа":[{name:"Франция",link:"#"},{name:"Германия",link:"#"},{name:"Италия",link:"#"},{name:"все туры на континенте",link:"#"}],"Россия":[{name:"Москва",link:"#"},{name:"Санкт-Петербург",link:"#"},{name:"все туры на континенте",link:"#"}],"Азия":[{name:"Китай",link:"#"},{name:"Япония",link:"#"},{name:"все туры на континенте",link:"#"}]};function renderCountriesList(e,t,n){let r=document.createElement("ul");r.className=t.main;let s=new DocumentFragment;for(let r in e){let a=document.createElement("li");a.className=n.main,a.textContent=r;let l=new DocumentFragment,o=document.createElement("ul");o.className=t.sub,e[r].forEach((t,s)=>{let a=document.createElement("li"),o=document.createElement("a");o.textContent=t.name,o.href=t.link,s==e[r].length-1?a.className=n.allTours:a.className=n.sub,a.append(o),l.append(a)}),o.append(l),a.append(o),s.append(a)}return r.append(s),r}function createCalendar(e,t,n){let r=new Date(t,n),s='<table class="calendar__table"><tr><th>Пн</th><th>Вт</th><th>Ср</th><th>Чт</th><th>Пт</th><th>Сб</th><th>Вс</th></tr><tr>';for(let e=0;e<getDay(r);e++)s+="<td></td>";for(;r.getMonth()==n;)s+=`<td>${r.getDate()}</td>`,getDay(r)%7==6&&(s+="</tr><tr>"),r.setDate(r.getDate()+1);if(0!=getDay(r))for(let e=getDay(r);e<7;e++)s+="<td></td>";s+="</tr></table>",e.innerHTML=s}function getDay(e){let t=e.getDay();return 0==t&&(t=7),t-1}let tripTypes=["Активный","Майские","На авто","На корабле","Новый год","Поход","Серфинг","Эксклюзив","Экскурсионный","Экспедиция"];function renderTripTypes(e,t,n){let r=document.createElement("ul");r.className=t;let s=new DocumentFragment;return e.forEach(e=>{let t=document.createElement("li"),r=document.createElement("span");r.textContent=e,t.className=n,t.append(r),s.append(t)}),r.append(s),r}